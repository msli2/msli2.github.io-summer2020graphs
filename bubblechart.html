<!DOCTYPE html>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link
    rel="stylesheet"
    href="https://maxcdn.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css"
  />
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"></script>
</head>
<style>
  .navbar {
    background-color: #212529;
  }
  .navbar .navbar-brand {
    font-size: 24px;
  }
  .navbar a,
  .list-group-item {
    color: white;
    font-size: 16px;
  }
  body {
    font-family: "Times New Roman", Times, serif;
    font-size: 16px;
  }
  .d3tipclass {
    line-height: 1;
    padding: 6px;
    background: #212529;
    color: #fff;
    font-size: 14px;
  }
  button,
  .card {
    border: none;
    background: none;
    display: block;
    text-align: left;
  }
  button:hover {
    background: #212529;
    color: white;
  }
  button:focus {
    outline: 0;
  }
  .card-header {
    background: none;
    font-size: 16px;
  }
  .card-body {
    font-size: 14px;
  }
  #accordion {
    border: 1px solid lightgrey;
  }
  .scroll {
    max-height: 300px;
    overflow-y: auto;
  }
  .svg-container {
    display: inline-block;
    position: relative;
    width: 100%;
    padding-bottom: 100%;
    vertical-align: top;
    overflow: hidden;
  }
  .svg-content {
    display: inline-block;
    position: absolute;
    top: 0;
    left: 0;
  }
  .options {
    border: 1px solid lightgrey;
    text-align: center;
  }
  .btn-group {
    padding-top: 20px;
    padding-bottom: 20px;
  }
</style>
<body>
  <script src="https://d3js.org/d3.v5.min.js"></script>
  <script src="d3-tip.js"></script>
  <nav class="navbar navbar-expand-md">
    <a class="navbar-brand" href="index.html">Summer 2020 Graphs</a>
    <ul class="navbar-nav">
      <li class="nav-item active">
        <a class="nav-link" href="index.html">Gender Differences</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="bubblechart.html">Recurring Actors</a>
      </li>
    </ul>
  </nav>
  <h5 style="padding-left: 15px; padding-top: 10px;">
    Recurring Actors for Each Female Director
  </h5>
  <div class="container-fluid">
    <div class="row" style="padding-left: 15px;">
      <div class="col-md-3">
        <div class="tableOfContents">
          <div
            style="border: 1px solid lightgrey; padding: 6px; margin-top: 10px;"
          >
            <h6
              style="
                padding: 5px;
                text-align: center;
                font-size: 17px;
                font-weight: 550;
              "
            >
              Summary About Director
            </h6>
            <div>
              <p id="summary" style="text-align: center; line-height: 1.2;"></p>
            </div>
          </div>
          <div class="btn-group d-flex">
            <h6
              class="w-100"
              style="padding-top: 4px; font-weight: 600; text-align: center;"
            >
              Color Options
            </h6>
            <button class="options w-100" onclick="chooseColor('value')">
              # of Films
            </button>
            <button class="options w-100" onclick="chooseColor('gender')">
              Gender
            </button>
          </div>
          <div id="accordion">
            <div class="card">
              <div
                class="card-header collapsed card-link"
                data-toggle="collapse"
                data-target="#collapseOne"
              >
                Female Directors
              </div>
              <div id="collapseOne" class="collapse" data-parent="#accordion">
                <div class="card-body scroll">
                  <button
                    class="col-md-12"
                    onclick="chooseDirector('Agnes Varda')"
                  >
                    Agnes Varda
                  </button>
                  <button
                    class="col-md-12"
                    onclick="chooseDirector('Agnieska Holland')"
                  >
                    Agnieska Holland
                  </button>
                  <button
                    class="col-md-12"
                    onclick="chooseDirector('Amy Heckerling')"
                  >
                    Amy Heckerling
                  </button>
                  <button
                    class="col-md-12"
                    onclick="chooseDirector('Anahita Ghazvinizadeh')"
                  >
                    Anahita Ghazvinizadeh
                  </button>
                  <button
                    class="col-md-12"
                    onclick="chooseDirector('Andrea Arnold')"
                  >
                    Andrea Arnold
                  </button>
                  <button
                    class="col-md-12"
                    onclick="chooseDirector('Barbara Kopple')"
                  >
                    Barbara Kopple
                  </button>
                  <button
                    class="col-md-12"
                    onclick="chooseDirector('Barbra Streisand')"
                  >
                    Barbra Streisand
                  </button>
                  <button
                    class="col-md-12"
                    onclick="chooseDirector('Chantal Akerman')"
                  >
                    Chantal Akerman
                  </button>
                  <button
                    class="col-md-12"
                    onclick="chooseDirector('Chloe Zhao')"
                  >
                    Chloe Zhao
                  </button>
                  <button
                    class="col-md-12"
                    onclick="chooseDirector('Claire Denis')"
                  >
                    Claire Denis
                  </button>
                  <button
                    class="col-md-12"
                    onclick="chooseDirector('Debra Granik')"
                  >
                    Debra Granik
                  </button>
                  <button
                    class="col-md-12"
                    onclick="chooseDirector('Dorothy Arzner')"
                  >
                    Dorothy Arzner
                  </button>
                  <button
                    class="col-md-12"
                    onclick="chooseDirector('Greta Gerwig')"
                  >
                    Greta Gerwig
                  </button>
                  <button
                    class="col-md-12"
                    onclick="chooseDirector('Jane Campion')"
                  >
                    Jane Campion
                  </button>
                  <button
                    class="col-md-12"
                    onclick="chooseDirector('Julie Dash')"
                  >
                    Julie Dash
                  </button>
                  <button
                    class="col-md-12"
                    onclick="chooseDirector('Kathryn Bigelow')"
                  >
                    Kathryn Bigelow
                  </button>
                  <button
                    class="col-md-12"
                    onclick="chooseDirector('Lana Wachowski')"
                  >
                    Lana Wachowski
                  </button>
                  <button
                    class="col-md-12"
                    onclick="chooseDirector('Lilly Wachowski')"
                  >
                    Lilly Wachowski
                  </button>
                  <button
                    class="col-md-12"
                    onclick="chooseDirector('Lina Wertmüller')"
                  >
                    Lina Wertmüller
                  </button>
                  <button
                    class="col-md-12"
                    onclick="chooseDirector('Lois Weber')"
                  >
                    Lois Weber
                  </button>
                  <button
                    class="col-md-12"
                    onclick="chooseDirector('Mary Harron')"
                  >
                    Mary Harron
                  </button>
                  <button
                    class="col-md-12"
                    onclick="chooseDirector('Mira Nair')"
                  >
                    Mira Nair
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div id="container" class="svg-container col-md-8"></div>
    </div>
    <script>
      var margin = { top: 60, right: 100, bottom: 40, left: 60 },
        width = 800 - margin.left - margin.right,
        height = 800 - margin.top - margin.bottom;

      var bubblechart = d3.pack().size([640, 600]).padding(2);

      var svg = d3
        .select("div#container")
        .append("svg")
        .attr("preserveAspectRatio", "xMinYMin meet")
        .attr("viewBox", "0 0 800 800")
        .classed("svg-content", true)
        .attr("class", "bubblechart")
        .append("g")
        .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

      chooseDirector("Agnes Varda");

      function chooseDirector(director) {
        d3.csv("actors.csv").then(function (data) {
          d3.selectAll("svg > g > *").remove();
          d3.selectAll("p#summary > text").remove();

          dataDirector = data.filter(function (d) {
            return d.director == director;
          });

          dataDirector.forEach(function (d) {
            d.value = parseInt(d.value);
          });

          var color = d3.scaleOrdinal([
            "#008777",
            "#67a1d1",
            "#b6bef6",
            "#ffdaff",
            "#fad3b4",
            "#f0a68a",
            "#ec7263",
          ]);

          svg
            .append("text")
            .attr("transform", "translate(" + width / 2 + "," + -20 + ")")
            .style("text-anchor", "middle")
            .style("font-size", 20)
            .style("font-weight", 550)
            .text("Director " + director);

          let maleNum = d3.sum(dataDirector, (d) => d.gender == "m");
          let femaleNum = d3.sum(dataDirector, (d) => d.gender == "f");
          var maxFilms = d3.max(dataDirector.map((d) => d.value));

          var summary = d3
            .select("p#summary")
            .append("text")
            .style("font-size", 17)
            .text(
              "Director " +
                director +
                " has " +
                (maleNum + femaleNum) +
                " recurring actors, " +
                maleNum +
                " male and " +
                femaleNum +
                " female. The highest number of actor recurrence is " +
                maxFilms +
                " films."
            );

          let tip = d3
            .tip()
            .attr("class", "d3tipclass")
            .direction("e")
            .offset([0, 5])
            .html(function (d) {
              var content =
                "<span style='margin-left: 2.5px;'><b>" +
                "Actor: " +
                d.data["actor"] +
                "</b></span><br>" +
                "<span style='margin-left: 2.5px;'><b>" +
                "# of Films: " +
                d.data["value"] +
                "</b></span><br>" +
                "<span style='margin-left: 2.5px;'><b>" +
                "Gender: " +
                d.data["gender"] +
                "</b></span><br>";
              return content;
            });
          svg.call(tip);

          var root = d3
            .hierarchy({ children: dataDirector })
            .sum((d) => d.value)
            .sort((a, b) => b.value - a.value);

          bubblechart(root);

          var bubbles = svg
            .selectAll(".bubblechart")
            .data(root.children)
            .enter();

          bubbles
            .append("circle")
            .attr("class", "circles")
            .attr("r", (d) => d.r)
            .attr("cx", (d) => d.x)
            .attr("cy", (d) => d.y)
            .style("fill", (d) => color(d.value))
            .style("stroke", "lightgrey")
            .style("stroke-width", 1)
            .on("mouseover", tip.show)
            .on("mouseout", tip.hide);
        });
      }

      function chooseColor(column) {
        var color = new Array();
        var choosenColor = d3.scaleOrdinal(color);
        if ("value" == column) {
          color = [
            "#008777",
            "#67a1d1",
            "#b6bef6",
            "#ffdaff",
            "#fad3b4",
            "#f0a68a",
            "#ec7263",
          ];
          choosenColor = d3.scaleOrdinal(color);
        } else if ("gender" == column) {
          let malefemale = ["m", "f", ""];
          choosenColor = d3
            .scaleOrdinal()
            .domain(malefemale)
            .range(["rgb(17, 138, 178)", "rgb(244, 124, 152)", "lightgrey"]);
        }

        d3.selectAll("circle")
          .transition()
          .duration(1000)
          .style("fill", (d) => choosenColor(d.data[column]));
      }
    </script>
  </div>
</body>
